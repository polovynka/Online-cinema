(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var a=n.getElementsByTagName("script");a.length&&(e=a[a.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();const e=(t,e)=>{t.classList.toggle(e)},n="67a5c365ff4299efc12a542bbae82e9d",a="https://api.themoviedb.org/3/",i="&language=ru-RU",o=t=>fetch(t).then((t=>{if(t.ok)return t.json();throw`Возникла ошибка ${t.status}`})).catch((t=>console.error(t)));let r="";const s=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"week",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r=`${a}trending/${t}/${e}?api_key=${n}${i}`,await o(r+`&page=${s}`)},l=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return r=`${a}${t}/popular?api_key=${n}${i}`,await o(r+`&page=${e}`)},c=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return r=`${a}${t}/top_rated?api_key=${n}${i}`,await o(r+`&page=${e}`)},u=async(t,e)=>{if("person"===t)return null;const r=`${a}${t}/${e}/videos?api_key=${n}${i}`;return await o(r)},p=t.p+"assets/2175f3c5250a3fb31aea.jpg",d=document.querySelector(".other-films__list"),g=document.querySelector(".button-pagination");let m="";const _=async(t,e)=>{d.textContent="",m=e,g.textContent="",Promise.all(t.results.map((async t=>{var n;e=t.media_type||e;const a=await u(e,t.id),i=null==a||null===(n=a.results[0])||void 0===n?void 0:n.key,o=document.createElement("li");o.className="other-films__item";const r=document.createElement("a");i&&(r.href=`https://youtu.be/${i}`),r.className="other-films__link",r.dataset.rating=t.vote_average.toFixed(1)||"-";const s=new Image;return s.className="other-films__img",s.alt=`постер ${t.title??t.name}`,s.src=t.poster_path?`https://www.themoviedb.org/t/p/w600_and_h900_bestv2/${t.poster_path}`:p,r.append(s),o.append(r),o}))).then((t=>d.append(...t))).then((()=>{if(t.total_pages>1){if(t.page>1){const e=document.createElement("button");e.classList.add("button-pagination-arrow"),e.dataset.page=t.page-1,e.textContent="<",g.append(e)}if(t.page<t.total_pages){const e=document.createElement("button");e.classList.add("button-pagination-arrow"),e.dataset.page=t.page+1,e.textContent=">",g.append(e)}g.style.textAlign="center",d.insertAdjacentElement("afterend",g)}}))};g.addEventListener("click",(async t=>{if(t.target.classList.contains("button-pagination-arrow")){const e=await(async t=>await o(r+`&page=${t}`))(t.target.dataset.page);_(e,m)}}));const h=_,v=document.querySelector(".film-week"),f=document.querySelector(".other-films__title"),w=document.querySelector(".film-week"),y=document.querySelectorAll(".get-nav"),$=document.querySelector(".other-films__title"),k=document.querySelector(".film-week"),b=document.querySelector(".header__search-form"),S=document.querySelector(".header__search-input");b.addEventListener("submit",(t=>{t.preventDefault(),S.value&&async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return r=`${a}search/multi?api_key=${n}${i}&query=${t}&include_adult=false`,await o(r+`&page=${e}`)}(S.value).then((t=>{if(!t.results.length)throw"К сожалению ничего не найдено";h(t)})).then((()=>{k.remove(),$.textContent="Результаты поиска"})).catch((t=>{$.textContent=t}))}));(t=>{let{openBtn:n,menu:a,classActiveMenu:i,closeTrigger:o}=t;const r=document.querySelector(n),s=document.querySelector(a),l=document.querySelectorAll(o);r.addEventListener("click",(()=>{e(s,i)})),l.forEach((t=>{t.addEventListener("click",(()=>{e(s,i)}))}))})({openBtn:".header__burger-btn",menu:".navigation",classActiveMenu:"navigation_active",closeTrigger:".navigation__link, .navigation__close"}),(async()=>{const t=await s(),[e]=t.results;((t,e)=>{let{key:n}=e;const{vote_average:a,backdrop_path:i,title:o,name:r,original_title:s,original_name:l}=t;v.innerHTML=`\n\t<div class="container film-week__container" data-rating="${a.toFixed(1)??"-"}">\n\t\t<div class="film-week__poster-wrapper">\n                    <img class="film-week__poster" src="https://www.themoviedb.org/t/p/w1920_and_h800_multi_faces${i}" alt="постер ${o??r}">\n                    <p class="film-week__title--origin">${s??l}</p>\n                </div>\n                <h2 class="film-week__title">${o??r}</h2>\n\t\t\t${n?`<a class="film-week__watch-trailer tube" href="https://youtu.be/${n}" aria-label="смотреть трейлер"></a>`:""}\n            </div>\n\t`})(e,(await u(e.media_type,e.id)).results[0]??""),h(t)})(),y.forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.closest(".get-nav__link");e&&(t.preventDefault(),w.style.display="none",f.textContent=e.textContent,e.classList.contains("get-nav__link--triends")&&s().then((t=>h(t))),e.classList.contains("get-nav__link--popular-movies")&&l("movie").then((t=>h(t,"movie"))),e.classList.contains("get-nav__link--popular-tv")&&l("tv").then((t=>h(t,"tv"))),e.classList.contains("get-nav__link--top-movies")&&c("movie").then((t=>h(t,"movie"))),e.classList.contains("get-nav__link--top-tv")&&c("tv").then((t=>h(t,"tv"))))}))}))})();
//# sourceMappingURL=main.js.map